require 'rbconfig'
HOST_OS=Config::CONFIG['host_os']

task :build do
  if HOST_OS=='mswin32'
    `cl -c getopt.c`
    `cl -c test.c`
    `link -OUT:test.exe test.obj getopt.obj`
  else
    `gcc -c getopt.c`
    `gcc -c test.c`
    `gcc -o test test.o getopt.o`
  end
end

task :clean do
  if HOST_OS=='mswin32'
    `del *.obj`
    `del test.exe`
  else
    `rm *.o`
    `rm test`
  end
end